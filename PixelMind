#include <raylib.h>
#include <stdio.h>
#include <math.h>
void sobrenos()
{      Music nos = LoadMusicStream("/jogoip/Warriors.ogg");
PlayMusicStream(nos);
SetMusicVolume(nos, 0.2);
   while(!WindowShouldClose())
   { UpdateMusicStream(nos);

 
 
       BeginDrawing();
      ClearBackground(RAYWHITE); 
      DrawText("Créditos:\nJogo desenvolvido pelos alunos de Ciência da Computação da UFRPE:  Izabelle Tais, Maely S. Coutinho, \nMarcos Bernardo, Marielly Lins e Pedro Araújo para cadeira de Introdução à Programação I. \nTem como intuito tornar palpável, de forma lúdica, a realidade de pessoas que diariamente convivem com \ndoenças/transtornos/distúrbios mentais. \nO nosso grupo gostaria de esclarecer que não somos especialistas no assunto e nos desculpar por qualquer erro que podemos \nter cometido no desenvolvimento desse projeto",10,10,20,BLACK);
      DrawText("Se você está passando por essas ou outras doenças/transtornos/distúrbios mentais e está em tratamento a equipe do PixelMind \ntorce pela sua estabilidade. \nSe você ainda não buscou ajuda esperamos que esses jogo tenha lhe mostrado a importância da terapia em sua melhora.",10,220,20,BLACK);
      DrawText("Esse é você.\n",500,300,20,BLACK);
      DrawText(" Ajude-se.\n",500,320,20,BLACK);
      DrawText("E por fim esse é um mundo com muitos Jorges, Karol’s, Guilhermes e Luizas.\n",10,350,20,BLACK);
      DrawText(" Ajude-o.",500,400,20,BLACK);   
      DrawText(" ENTER PARA VOLTAR ",500,450,20,RED);   
      if (IsKeyPressed(KEY_ENTER)){
          menu();
      }
    EndDrawing();
   }
    CloseWindow();
}
typedef struct 
{
   int raio;
   int x,y;      
}circulo;
void movimentacao(Rectangle* Jorger)
{
        if (IsKeyDown(KEY_DOWN))
        {
            (Jorger->y)+= 4; //y cresce para baixo.
        }
        else if(IsKeyDown(KEY_UP))
        {
            (Jorger->y) -= 4;
        }
        else if(IsKeyDown(KEY_RIGHT))
        {
            (Jorger->x) +=4;
        }
        else if(IsKeyDown(KEY_LEFT))
        {
            (Jorger->x) -=4;
        }
            
    
}

void colisao(Rectangle* Jorger)
{ 
           if(IsKeyDown(KEY_LEFT))
           
           {
               (Jorger->x)+=4;
               
           }
           if(IsKeyDown(KEY_RIGHT))
           {
               (Jorger->x)-=4;
               
           }
           if(IsKeyDown(KEY_UP))
           {
               (Jorger->y)+=4;
           }
           if(IsKeyDown(KEY_DOWN))
           {
               (Jorger->y)-=4;
               
           } 
    
}


void tamanhotela(Rectangle* Jorger, int screenHeight,int screenWidth)
{
        if(Jorger->x+53>screenWidth)
        {
            Jorger->x = screenWidth-53;
        }
        else if(Jorger->x-8<0) 
        {
            Jorger->x=0+8;
        }
        else if(Jorger->y+52>screenHeight)
        {
            Jorger->y=screenHeight-52;
        }
        else if(Jorger->y-10<0)
        {
            Jorger->y=0+10;
        }
}


void desenharconflito(Texture2D fala)
{
     
     DrawTexture(fala,0,570,RAYWHITE);
      DrawText("CONFLITO: Ir para a festa de Carla.\nAjude Jorge a deixar seus pensamentos mais funcionais",220,630,20,WHITE);
      DrawText("[PRESS A] Ninguém me quer lá\n[PRESS B] Vai ser divertido!",220,680,20,WHITE);
     
}
void desenharconflito2(Texture2D fala)
{
     
     DrawTexture(fala,0,570,RAYWHITE);
     DrawText("CONFLITO: Na festa, alguém te chamou para dançar.\n",220,630,20,WHITE);
     DrawText("[PRESS A] Sim. Estou entre amigos, ninguém vai ligar\n[PRESS B] Não. Vou passar vergonha",220,680,20,WHITE);
     
}
void desenharconflito3(Texture2D fala)
{
     
     DrawTexture(fala,0,570,RAYWHITE);
     DrawText("CONFLITO: Alguém está olhando para você.\n",220,630,20,WHITE);
     DrawText("[PRESS A] Talvez ela queira conversar\n[PRESS B] Há algo de errado comigo",220,680,20,WHITE);
     
}

void desenharconflito4(Texture2D fala)
{
     
     DrawTexture(fala,0,570,RAYWHITE);
     DrawText("CONFLITO: Apresentar trabalho em público.\nAjude Jorge a deixar seus pensamentos mais funcionais",220,630,20,WHITE);
     DrawText("[PRESS A] Todo mundo já esteve na mesma situação\n[PRESS B] Todos vão estar me julgando",220,680,20,WHITE);
     
}
void desenharconflito5(Texture2D fala)
{
     
     DrawTexture(fala,0,570,RAYWHITE);
     DrawText("CONFLITO: Um grupo de pessoas está rindo no fundo da sala.\n",220,630,20,WHITE);
     DrawText("[PRESS A] Estão rindo de mim\n[PRESS B] Eles conversam em todas as aulas",220,680,20,WHITE);
}
void desenharconflito6(Texture2D fala)
{
     
     DrawTexture(fala,0,570,RAYWHITE);
     DrawText("CONFLITO: O professor está escrevendo algo em sua prancheta.\n",220,630,20,WHITE);
     DrawText("[PRESS A] Ele só está tomando notas\n[PRESS B] Eu estou falando tudo errado",220,680,20,WHITE);
     
}
void desenharconflito7(Texture2D fala)
{
     
     DrawTexture(fala,0,570,RAYWHITE);
     DrawText("CONFLITO: Estar em um elevador cheio.\nAjude Jorge a deixar seus pensamentos mais funcionais",220,630,20,WHITE);
     DrawText("[PRESS A] Vou ficar sem ar!\n[PRESS B] Vai dar tudo certo!",220,680,20,WHITE);
     
}
void desenharconflito8(Texture2D fala)
{
     
     DrawTexture(fala,0,570,RAYWHITE);
     DrawText("CONFLITO: O lugar está apertado.\n",220,630,20,WHITE);
     DrawText("[PRESS A] Tem mais gente do que o elevador aguenta\n[PRESS B] Só está um pouco cheio",220,680,20,WHITE);
     
}
void desenharconflito9(Texture2D fala)
{
     
     DrawTexture(fala,0,570,RAYWHITE);
     DrawText("CONFLITO: Você está com medo de ficar preso.",220,630,20,WHITE);
     DrawText("[PRESS A] Vou fazer exercício de respiração\n[PRESS B] Acho que vou morrer!",220,680,20,WHITE);
     
}
void batalhafuncao(int* ruim,int opc, int* batalha)
{
   if(opc == 1)
   {
       if(IsKeyPressed(KEY_A)) //A=ruim, B=bom;
       {
           (*ruim)++;
           (*batalha)++;
       }
       else if(IsKeyPressed(KEY_B))
       {
           (*ruim)--;
           (*batalha)++;
       }
   }
   else if(opc == 2)
   {
       if(IsKeyPressed(KEY_A)) //A=bom, B=ruim;
       {
           (*ruim)--;
           (*batalha)++;
       }
       else if(IsKeyPressed(KEY_B))
       {
           (*ruim)++;
           (*batalha)++;
       }
       
   }
}

void batalhafuncao2(Texture2D fala,int* ruim, int* batalha,int* falac)
{
     (*falac)=1;
      if((*batalha)==1)
      {
          desenharconflito(fala);
          batalhafuncao(&(*ruim),1,&(*batalha)); 
          
      }
      else if((*batalha)==2)
      {
          desenharconflito2(fala);
          batalhafuncao(&(*ruim),2,&(*batalha));
          
      }    
      else if((*batalha)==3)
      {
        desenharconflito3(fala);
        batalhafuncao(&(*ruim),2,&(*batalha));
      } 
      else if((*batalha)==4)
      {
        (*batalha)=0;
      }          
        
       
        
}
void batalhafuncao3(Texture2D fala,int* ruim, int* batalha,int* falac)
{
      (*falac)=1;
      if((*batalha)==1)
      {
          desenharconflito4(fala);
          batalhafuncao(&(*ruim),2,&(*batalha)); 
          
      }
      else if((*batalha)==2)
      {
          desenharconflito5(fala);
          batalhafuncao(&(*ruim),1,&(*batalha));
          
      }    
      else if((*batalha)==3)
      {
        desenharconflito6(fala);
        batalhafuncao(&(*ruim),2,&(*batalha));
      } 
      else if((*batalha)==4)
      {
        (*batalha)=0;
      }              
        
}
void batalhafuncao4(Texture2D fala,int* ruim, int* batalha,int* falac)
{
      (*falac=1);
      if((*batalha)==1)
      {
          desenharconflito7(fala);
          batalhafuncao(&(*ruim),1,&(*batalha)); 
          
      }
      else if((*batalha)==2)
      {
          desenharconflito8(fala);
          batalhafuncao(&(*ruim),1,&(*batalha));
          
      }    
      else if((*batalha)==3)
      {
        desenharconflito9(fala);
        batalhafuncao(&(*ruim),2,&(*batalha));
      } 
      else if((*batalha)==4)
      {
        (*batalha)=0;
      }                
}

void atualizarestabilidade(int* stress,int* estabilidade)//mudar nome dessa função
{
       if((*stress)>= 10)
    {
        (*estabilidade) = *estabilidade-2;
        (*stress)=5;
    }
    if((*stress) == 0)
    {
        (*estabilidade) = *estabilidade+2;
        (*stress)=5;
    }else
    if((*stress) == -1){
        (*estabilidade) = *estabilidade+2;
        (*stress) = 4;
    }else
    if((*stress) == -2){
        (*estabilidade) = *estabilidade+2;
        (*stress) = 3;
    }else
    if((*stress) == -3){
        (*estabilidade) = *estabilidade+2;
        (*stress) = 2;
    }else
    if((*stress) <= -3){
        (*estabilidade) = *estabilidade+2;
        (*stress) = 2;
    }
    
}
void diversaoaviso(Texture2D fala,int* falac, Rectangle* Jorger, Rectangle falacolisao)
{
     (*falac)=1;
     int contador = 0;
     contador++;
     int segundos = 0;
     if(contador%60 == 0)
     {
         segundos++;
     }
     DrawTexture(fala,0,570,RAYWHITE);
     DrawText(TextFormat("Está na hora de Jorge se divertir %i", segundos),370,700,20,WHITE);  
     
}
void terapiaaviso(Texture2D fala,int* falac, Rectangle* Jorger, Rectangle falacolisao)
{
     (*falac)=1;
     
     DrawTexture(fala,0,570,RAYWHITE);
     if((Jorger->x >= falacolisao.x) && (Jorger->y >= falacolisao.y))
     {
         Jorger->y = 525;
     }
     DrawText("Está na hora de Jorge ir à terapia",210,660,20,WHITE);
     
}
/*
Coisas dos outros personagens
//Image Karolim = LoadImage("/jogoip/Karol01.png");
//Image Guilhermeim = LoadImage("/jogoip/Guilherme01.png");
//ImageResize (&Karolim,144,104);
//ImageResize (&Guilhermeim,144,104);
//Texture2D Karoltx = LoadTextureFromImage(Karolim);
//Texture2D Guilhermetx = LoadTextureFromImage(Guilhermeim);
*/
void tudoDoJorge(){
    
    int screenWidth = 1366; //dimenssão da minha tela
    int screenHeight = 768;
    
    int contadordetempo = 0;
    
    //Carregando imagem e transformando em textura:
    //Image:
        Image Quarto = LoadImage("/jogoip/Quarto002.png"); //diretorio apartir do C: com as \ invertidas (/);
        Image Jorgeim = LoadImage("/jogoip/Jorge01.png");
        Image memoriasim = LoadImage("/jogoip/memorias.png");
        Image monstro = LoadImage("/jogoip/monstro2.png");
        Image fala = LoadImage("/jogoip/fala.png");
     //Image Resize:
        ImageResize (&Jorgeim,144,104); //144,104,(108,78) - Aumentando a imagem original
        ImageResize (&Quarto,1366,788); //passar o endereço pq ele modifica a imagem original.
        ImageResize (&fala,1366,300);
        ImageResize (&monstro,1300,678);
     //Texture2D:
        Texture2D Quartotx = LoadTextureFromImage(Quarto);
        Texture2D Jorgetx = LoadTextureFromImage(Jorgeim);
        Texture2D memoriastx = LoadTextureFromImage(memoriasim);
        Texture2D falatx = LoadTextureFromImage(fala);
        Texture2D monstrotx = LoadTextureFromImage(monstro);
        Texture2D estabilidadetx = LoadTexture("/jogoip/estabilidade.png");
        Texture2D estressetx = LoadTexture("/jogoip/estresse.png");
     //Rectengles:
        Rectangle Jorgerec = {0,0,53,102};// testando o tamanho do boneco no mapa (pegando só esse retângulo)
        //Rectangle Karolrec = {0,0,55,102}; // Esta ok
        //Rectangle Guilhermerec = {0,0,55,102}; //se desejar aumentar manter a proporção para os 3 bonecos (usar multiplo)
       //Retângulo de movimentação:
        Rectangle Jorger = {17,400,53,51}; //um retângulo de colisão que representa Jorge (metade da altura para colidir com o pé)
       //criando colisão
        Rectangle estante = {330,116,979,180}; //colisão para a estante
        Rectangle memoria1 = {500,325,20,3};
        Rectangle memoria2 = {600,325,20,3};
        Rectangle memoria3 = {600,525,20,5};
        Rectangle memoria4 = {965,340,20,3};
        Rectangle memoria5 = {1025,560,30,5};
        Rectangle memoria6 = {130,520,30,5}; 
        Rectangle memoria10 = {995,400,30,3};
        Rectangle memoria11 = {1030,400,30,3};
        Rectangle memoriasad1 = {800,600,20,5};
        Rectangle memoriasad2 = {255,380,20,5};
        Rectangle memoriasad3 = {1270,540,30,5};
        Rectangle conflito = {930,300,70,80};
        Rectangle conflito2 = {995,400,70,80};
        Rectangle conflito3 = {1030,400,70,80};
        Rectangle mesa = {525,405,305,100};
        Rectangle pe1= {570,515,20,15};
        Rectangle pe2= {790,515,20,15};
        Rectangle lixo = {1070,304,113,20};
        Rectangle parede1 = {0,0,190,340};
        Rectangle parede2 = {1166,0,190,340};
        Rectangle parede3 = {221,304,55,20};
        Rectangle parede4 = {0,669,190,340};
        Rectangle parede5 = {1166,669,190,340};
        //Rectangle p1 = {};
        //Rectangle p2 = {};
        //Rectangle p3 = {};
        Rectangle falacolisao = {0,630,1300,300};
        Rectangle refletirec = {636,390,20,20};
        
        //recorte de imagem:
        Rectangle memoriasrec = {0,0,30,20}; //ok!
        Rectangle memoriassadrec = {30,20,30,20}; //ok!
        Rectangle conflitorec = {60,40,35,20};
        Rectangle monstrorec = {0,0,90,90};
        
       
        
        
       //posição das memórias:
        Vector2 memoriasp = {500,325}; //ferias com a família
        Vector2 memoriasp2 = {600,325}; //ganhou um ps4
        Vector2 memoriasp3 = {600,525}; //passou de ano
        Vector2 memoriasp5 = {130,520}; //conseguiu vencer algum medo 
        Vector2 memoriasp6 = {1025,560}; //fez uma nova amizade
        Vector2 memoriaspsad1 = {800,600}; //perdeu contato com um amigo querido
        Vector2 memoriap4 = {965,340};
        Vector2 memoriap10 = {1025,443};
        Vector2 memoriap11 = {1000,443};
        Vector2 memoriaspsad2 = {255,380}; //morte de um familiar
        Vector2 memoriaspsad3 = {1270,540}; //teve uma crise de pânico em público 
        Vector2 conflitop = {900,300};
        Vector2 conflitop2 = {965,400};
        Vector2 conflitop3 = {1000,400};
         
        
    //variáveis :
    int memoria = 0;
    int stress = 5; //chegando a 0 aumenta estabilidade, chegando a 10 diminui.
    int estabilidade = 10; //chegando a 30 (exemplo) passa de nível, chegando a 0 perde
    int sad = 0; 
    int desafio = 0;
    int batalha = -1;
    int batalha2= -1;
    int batalha3= -1;
    int ruim = 0;
    int ruim2=0;
    int ruim3=0;
    int desenhar = 1;
    int diversao = 0;
    int terapia = 0;
    int falac=0;
    int checkpoint = 0;
    int refletir=0;
    checkpoint = qual_level(0);
    int desenharmemoria[15] = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};
    Music ewof = LoadMusicStream("/jogoip/Ewof.ogg");
    PlayMusicStream(ewof);
    SetMusicVolume(ewof, 0.2);
    while (!WindowShouldClose())   
    { 
       UpdateMusicStream(ewof);
        //CONDIÇÃO PARA SUBIR DE NIVEL
        if(estabilidade >= 30){
            subiu_de_level();
            menu();
        }
        /*
        Coisas da Karol e do Guilherme:
        //Vector2 Karolp = {circulo1.posicaox+100,circulo1.posicaoy+49};
        // Vector2 Guilhermep = {circulo1.posicaox+100,circulo1.posicaoy+49};
        
        */
         contadordetempo++;
         Vector2 Jorgep = {Jorger.x,Jorger.y-51}; //posição do Jorge (menos 51 para a colisão ficar no pé)
         //Posição do mouse na tela
         int x = GetMouseX();
         int y = GetMouseY();
        //colisão especifica 
          /*circulo jogador;
          circulo parede6;
          circulo parede7;
          jogador.raio= 25;
          jogador.x=Jorger.x;
          jogador.y=Jorger.y;
          parede6.raio=35;
          parede7.raio=35;
          parede6.x= 35;
          parede6.y=705; */
        //função de movimentação do jorge:
        if(desafio==0)
        {
            movimentacao(&Jorger);
        }
         
        //Checando se saiu do mapa:
        tamanhotela(&Jorger,screenHeight,screenWidth);
        //atualizando estabilidade:
        atualizarestabilidade(&stress,&estabilidade);
        
        //checando colisão:
       //int distancia = sqrt(((jogador.x - parede6.x)^2) + ((jogador.y - parede6.y)^2)); 
        
       // if(parede6.raio + jogador.raio < distancia)
        {
            //colisao(&Jorger);
        }
        if(CheckCollisionRecs(Jorger,estante)==1)
        {
            Jorger.y+=4;
            if(memoria==1 && IsKeyPressed(KEY_ENTER)==1)
            {
                if(sad==0)
                {
                    stress = stress-2;
                }
                else
                {
                    stress = stress+2;
                    sad=0;
                }
                
                memoria=0;
            }
        }
        
        else if(CheckCollisionRecs(Jorger,mesa)==1 ||CheckCollisionRecs(Jorger,pe1)==1|| CheckCollisionRecs(Jorger,pe2)==1)
        {
            colisao(&Jorger);
        }
        else if(CheckCollisionRecs(Jorger,parede1)==1) 
        {
            colisao(&Jorger);
            if(diversao==1)
            {
                
                desenhar=0;
                stress = stress - 5;
                diversao=0;
            }
            
        }
        else if(CheckCollisionRecs(Jorger,parede2)==1)
        {
            colisao(&Jorger);
            if(terapia==1)
            {
                desenhar=0;
                estabilidade = estabilidade + 5;
                terapia=0;
            }
            
        }
        else if(CheckCollisionRecs(Jorger,parede3))
        {
            colisao(&Jorger); 
        }
        else if(CheckCollisionRecs(Jorger,falacolisao))
        {
            if(falac==1)
            {
                colisao(&Jorger); 
                falac=0;
            }
               
        }
        else if(CheckCollisionRecs(Jorger,parede4)) 
        {
            colisao(&Jorger);  
        }
        else if(CheckCollisionRecs(Jorger,parede5))
        {
           colisao(&Jorger);  
        }
        else if(CheckCollisionRecs(Jorger,memoria1)==1)
        {
            if(IsKeyPressed(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[0]=0;
                 memoria=1;
                 memoria1.x=0;
                 memoria1.y=0;
            }
            
            colisao(&Jorger);
        }
        else if(CheckCollisionRecs(Jorger,memoria2)==1)
        {
            if(IsKeyPressed(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[1]=0;
                 memoria=1;
                 memoria2.x=0;
                 memoria2.y=0;
            }
            colisao(&Jorger);
        }
        else if(CheckCollisionRecs(Jorger,memoria3))
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[2]=0;
                 memoria=1;
                 memoria3.x=0;
                 memoria3.y=0;
            }
            colisao(&Jorger);
        }
        else if(CheckCollisionRecs(Jorger,memoria4) && contadordetempo>=3600)
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[5]=0;
                 if(ruim>0)
                 {
                     memoria=1;
                     sad=1;
                     //criou um memória ruim:
                     stress = stress+3;
                     
                 }
                 else
                 {
                     memoria=1;
                     //recompensa por ter dado certo:
                     stress = stress-3;
                 }
                 
                 memoria4.x=0;
                 memoria4.y=0;
            }
            colisao(&Jorger);
        }
        else if(CheckCollisionRecs(Jorger,memoria10) && contadordetempo>=3600*3)
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[11]=0;
                 if(ruim2>0)
                 {
                     memoria=1;
                     sad=1;
                     //criou um memória ruim:
                     stress = stress+3;
                     
                 }
                 else
                 {
                     memoria=1;
                     //recompensa por ter dado certo:
                     stress = stress-3;
                 }
                 
                 memoria10.x=0;
                 memoria10.y=0;
            }
            colisao(&Jorger);
        }
        else if(CheckCollisionRecs(Jorger,memoria11) && contadordetempo>=3600*5)
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[13]=0;
                 if(ruim3>0)
                 {
                     memoria=1;
                     sad=1;
                     //criou um memória ruim:
                     stress = stress+3;
                     
                 }
                 else
                 {
                     memoria=1;
                     //recompensa por ter dado certo:
                     stress = stress-3;
                 }
                 
                 memoria11.x=0;
                 memoria11.y=0;
            }
            colisao(&Jorger);
        }
        else if(CheckCollisionRecs(Jorger,conflito)==1 && contadordetempo>=3600)
        {
            if(IsKeyDown(KEY_ENTER))
            {
                 
                 batalha=1;
                 desafio=1;
                 
                
            }
            colisao(&Jorger);
        }
        else if(CheckCollisionRecs(Jorger,conflito2)==1 && contadordetempo>=3600*3)
        {
            if(IsKeyDown(KEY_ENTER))
            {
                 
                 batalha2=1;
                 desafio=2;  
                
            }
            colisao(&Jorger);
        }
        else if(CheckCollisionRecs(Jorger,conflito3)==1 && contadordetempo>=3600*5)
        {
            if(IsKeyDown(KEY_ENTER))
            {
                 
                 batalha3=1;
                 desafio=3;  
                
            }
            colisao(&Jorger);
        }
        else if(CheckCollisionRecs(Jorger,memoriasad1))
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[3]=0;
                 memoria=1;
                 sad=1;
                 memoriasad1.x=0;
                 memoriasad1.y=0;
            }
            colisao(&Jorger);
        }
        else if(CheckCollisionRecs(Jorger,memoriasad2))
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[7]=0;
                 memoria=1;
                 sad=1;
                 memoriasad2.x=0;
                 memoriasad2.y=0;
            }
            colisao(&Jorger);
        }
        else if(CheckCollisionRecs(Jorger,memoriasad3))
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[8]=0;
                 memoria=1;
                 sad=1;
                 memoriasad3.x=0;
                 memoriasad3.y=0;
            }
            colisao(&Jorger);
        }
        else if(CheckCollisionRecs(Jorger,memoria5))
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[9]=0;
                 memoria=1;
                 memoria5.x=0;
                 memoria5.y=0;
            }
            colisao(&Jorger);
        }
        else if(CheckCollisionRecs(Jorger,memoria6))
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[6]=0;
                 memoria=1;
                 memoria6.x=0;
                 memoria6.y=0;
            }
            colisao(&Jorger);
        }
        else if (CheckCollisionRecs(Jorger,lixo))
        {
           if(IsKeyPressed(KEY_ENTER)==1 && memoria==1)
            {
                if(sad==1)
                {
                    stress--;
                    sad=0;
                }
                else
                {
                    stress = stress+3;
                }
                 memoria=0;
            }
            colisao(&Jorger); 
        }
        else if(CheckCollisionRecs(Jorger,refletirec) && refletir==1)
        {
            if(IsKeyPressed(KEY_ENTER)==1 && memoria==1)
            {                
                if(sad==1)
                {
                    stress-=2;
                    memoria=0;
                    sad=0;
                    refletir=0;
                }
                else
                {
                    estabilidade+=1;
                    memoria=0;
                    refletir=0;
                }
            }
        }            

        
            int minutos = 3600;
            if(contadordetempo==2*minutos)
            {
                diversao=1;
                
            }
            if(contadordetempo==4*minutos)
            {
                terapia=1;
                refletir=1;
            }
            if(contadordetempo==6*minutos)
            {
                diversao=1;
                
            }
            if(contadordetempo==8*minutos)
            {
                terapia=1;
                refletir=1;
               
            }
            if(contadordetempo==10*minutos)
            {
                diversao=1;
                
            }
        
        //parte gráfica:
        BeginDrawing();
           ClearBackground(WHITE);
           DrawTexture(Quartotx,0,0,RAYWHITE);
           //DrawTexture(circulo1.posicaox,circulo1.posicaoy,RAYWHITE);
           //DrawTextureRec(Texture2D texture, Rectangle sourceRec, Vector2 position, Color tint); 
           DrawText(TextFormat("x: %i y: %i",x,y),605,15,40,RED);
           DrawText(TextFormat("Memoria: %i",memoria),15,680,35,BLACK);
           DrawTexture(estabilidadetx, 35, 8, WHITE);
           DrawTexture(estressetx, 35, estabilidadetx.height + 16, WHITE);
           DrawRectangleGradientH(39, 36,((estabilidade*0.1)/3)*325, 26, SKYBLUE, DARKBLUE);
           DrawRectangleGradientH(39, 104,(stress*0.1)*325, 25, RED, (Color){123, 20, 34, 255});
           DrawText(TextFormat("Refletir: %i",refletir),15,710,35,BLACK);
           DrawText(TextFormat("Fase 1"),629,94,35,BLACK);
           DrawText(TextFormat("Tempo: %0.1f", (float)(contadordetempo/100)),1150,42,30,BLACK);
           //DrawTextureRec(Karoltx,Karolrec,Karolp,RAYWHITE);
           //DrawTextureRec(Guilhermetx,Guilhermerec,Guilhermep,RAYWHITE);
           
           // desenhando memórias:
           if(desenharmemoria[0]==1)
           {
              DrawTextureRec(memoriastx,memoriasrec,memoriasp,RAYWHITE); 
           }
           if(desenharmemoria[1]==1)
           {
              DrawTextureRec(memoriastx,memoriasrec,memoriasp2,RAYWHITE);
           }
           if(desenharmemoria[2]==1)
           {
              DrawTextureRec(memoriastx,memoriasrec,memoriasp3,RAYWHITE);
           }
           if(desenharmemoria[3]==1)
           {
              DrawTextureRec(memoriastx,memoriassadrec,memoriaspsad1,RAYWHITE);
           }
           if(desenharmemoria[4]==1 && contadordetempo >= 3600)
           {
              DrawTextureRec(monstrotx,monstrorec,conflitop,RAYWHITE);
           }
           if(desenharmemoria [9] == 1)
           {
               DrawTextureRec(memoriastx,memoriasrec,memoriasp6,RAYWHITE);
           }
           if(desenharmemoria[6] == 1)
           {
               DrawTextureRec(memoriastx,memoriasrec,memoriasp5,RAYWHITE);
           }
           if(desenharmemoria[7] == 1)
           {
               DrawTextureRec(memoriastx,memoriassadrec,memoriaspsad2,RAYWHITE);
           }
           if(desenharmemoria[8] == 1)
           {
               DrawTextureRec(memoriastx,memoriassadrec,memoriaspsad3,RAYWHITE);
           }
           if(desenharmemoria[10] == 1 && contadordetempo >= 3600*3)
           {
               DrawTextureRec(monstrotx,monstrorec,conflitop2,RAYWHITE);
           }
           if(desenharmemoria[12] == 1 && contadordetempo >= 3600*5)
           {
               DrawTextureRec(monstrotx,monstrorec,conflitop3,RAYWHITE);
           }
           //desenhando desafio:
           if(desafio==1)
           {
               
               if(batalha>=1)
               {
                   batalhafuncao2(falatx,&ruim,&batalha,&falac);
                   
               }
               if(batalha==0)
               {
                   desenharmemoria[4]=0;
                   desafio=0;
                   conflito.x=0;
                   conflito.y=0;
                   
               }
               
               
           }
           if(batalha==0 && ruim<0)
            {
                   if(desenharmemoria[5]==1)
                   {
                      DrawTextureRec(memoriastx,memoriasrec,memoriap4,RAYWHITE); 
                   }
                  
                 
            }    
            else if(batalha==0 && ruim>0)
            {
                   if(desenharmemoria[5]==1)
                   {
                      DrawTextureRec(memoriastx,memoriassadrec,memoriap4,RAYWHITE);
                   }
                   
            }
            if(desafio==2)
           {
               
               if(batalha2>=1)
               {
                   batalhafuncao3(falatx,&ruim2,&batalha2,&falac);
                   
               }
               if(batalha2==0)
               {
                   desenharmemoria[10]=0;
                   desafio=0;
                   conflito2.x=0;
                   conflito2.y=0;
                   
               }
               
               
           }
           if(batalha2==0 && ruim2<0)
            {
                   if(desenharmemoria[11]==1)
                   {
                      DrawTextureRec(memoriastx,memoriasrec,memoriap10,RAYWHITE); 
                   }
                  
                 
            }    
            else if(batalha2==0 && ruim2>0)
            {
                   if(desenharmemoria[11]==1)
                   {
                      DrawTextureRec(memoriastx,memoriassadrec,memoriap10,RAYWHITE);
                   }
                   
            }
            if(desafio==3)
           {
               
               if(batalha3>=1)
               {
                   batalhafuncao4(falatx,&ruim3,&batalha3,&falac);
                   
               }
               if(batalha3==0)
               {
                   desenharmemoria[12]=0;
                   desafio=0;
                   conflito3.x=0;
                   conflito3.y=0;
                   
               }
               
               
           }
           if(batalha3==0 && ruim3<0)
            {
                   if(desenharmemoria[13]==1)
                   {
                      DrawTextureRec(memoriastx,memoriasrec,memoriap11,RAYWHITE); 
                   }
                  
                 
            }    
            else if(batalha3==0 && ruim3>0)
            {
                   if(desenharmemoria[13]==1)
                   {
                      DrawTextureRec(memoriastx,memoriassadrec,memoriap11,RAYWHITE);
                   }
                   
            }
           //diversao e terapia:
           if(diversao==1 && desafio==0)
           {
               diversaoaviso(falatx, &falac, &Jorger, falacolisao);
           }
           if(terapia==1 && desafio==0)
           {
               terapiaaviso(falatx, &falac, &Jorger, falacolisao);
           }
           int espera = 1000; //modificar essa variável para reduzir o tempo de espera
           if(contadordetempo>=(2*minutos)+espera && contadordetempo<(4*minutos)) 
           {
               desenhar=1;
           }
           if(contadordetempo>=(4*minutos)+espera && contadordetempo<(6*minutos))
           {
               desenhar=1;
           }
           if(contadordetempo>=(6*minutos)+espera && contadordetempo<(8*minutos))
           {
               desenhar=1;
           }
           if(contadordetempo>=(8*minutos)+espera && contadordetempo<(10*minutos))
           {
               desenhar=1;
           }
           if(contadordetempo>=(10*minutos)+espera)
           {
               desenhar=1;
           }
           if(desenhar==1)
           {
               DrawTextureRec(Jorgetx,Jorgerec,Jorgep,RAYWHITE);
           }
           if(estabilidade >= 30)
           {
               subiu_de_level();
           }
        EndDrawing();
    }
    CloseWindow();
    
}

void move_circ(int* posic)
{
    if(IsKeyPressed(KEY_UP))
    {
        if((*posic) > 470)
        {
            (*posic) -= 50;
        }
    }
    if(IsKeyPressed(KEY_DOWN))
    {
        if((*posic) < 600)
        {
            (*posic) += 50;
        }
    }
}
void movimentacaoK(Rectangle* Karolr)
{
        if (IsKeyDown(KEY_DOWN))
        {
            (Karolr->y)+= 4; //y cresce para baixo.
        }
        else if(IsKeyDown(KEY_UP))
        {
            (Karolr->y) -= 4;
        }
        else if(IsKeyDown(KEY_RIGHT))
        {
            (Karolr->x) +=4;
        }
        else if(IsKeyDown(KEY_LEFT))
        {
            (Karolr->x) -=4;
        }
            
    
}

void colisaoK(Rectangle* Karolr)
{ 
           if(IsKeyDown(KEY_LEFT))
           
           {
               (Karolr->x)+=4;
               
           }
           if(IsKeyDown(KEY_RIGHT))
           {
               (Karolr->x)-=4;
               
           }
           if(IsKeyDown(KEY_UP))
           {
               (Karolr->y)+=4;
           }
           if(IsKeyDown(KEY_DOWN))
           {
               (Karolr->y)-=4;
               
           } 
    
}


void tamanhotelaK(Rectangle* Karolr, int screenHeight,int screenWidth)
{
        if(Karolr->x+53>screenWidth)
        {
            Karolr->x = screenWidth-53;
        }
        else if(Karolr->x-8<0) 
        {
            Karolr->x=0+8;
        }
        else if(Karolr->y+52>screenHeight)
        {
            Karolr->y=screenHeight-52;
        }
        else if(Karolr->y-10<0)
        {
           Karolr->y=0+10;
        }
}

void diversaoavisoK(Texture2D fala,int* falac, Rectangle* Karolr, Rectangle falacolisao)
{
     (*falac)=1;
     DrawTexture(fala,237,650,RAYWHITE);
     if((Karolr->x >= falacolisao.x) && (Karolr->y >= falacolisao.y))
     {
         Karolr->y = 525;
     }
     DrawText("Está na hora de Karol se divertir",450,720,20,WHITE);  
     
}
void terapiaavisoK(Texture2D fala,int* falac, Rectangle* Karolr, Rectangle falacolisao)
{
     (*falac)=1;
     DrawTexture(fala,237,650,RAYWHITE);
     if((Karolr->x >= falacolisao.x) && (Karolr->y >= falacolisao.y))
     {
         Karolr->y = 525;
     }
     DrawText("Está na hora de Karol ir para a terapia",450,720,20,WHITE);  
     
}
void remedioavisoK(Texture2D fala,int* falac, Rectangle* Karolr, Rectangle falacolisao)
{
     (*falac)=1;
     DrawTexture(fala,237,650,RAYWHITE);
     if((Karolr->x >= falacolisao.x) && (Karolr->y >= falacolisao.y))
     {
         Karolr->y = 525;
     }
     DrawText("Está na hora de Karol tomar seu remedio",450,720,20,WHITE);  
     
}
void desafiofuncaoK(Texture2D fala, int* ruim,int* falac)
{
    (*falac)=1;
    if((*ruim)==1)
    {
        DrawTexture(fala,237,650,RAYWHITE);
        DrawText("Você tem certeza que esse dia foi bom?",450,720,20,RED);  
    }
    if((*ruim)==2)
    {
        DrawTexture(fala,237,650,RAYWHITE);
        DrawText("Tem certeza que não fez nada de errado?",450,720,20,RED);  
    }
    if((*ruim)==3)
    {
        DrawTexture(fala,237,650,RAYWHITE);
        DrawText("Pense de novo!",500,720,20,RED);  
    }
    if((*ruim)==4)
    {
        DrawTexture(fala,237,650,RAYWHITE);
        DrawText("Você sempre faz algo de errado",450,720,20,RED);
    }
    if((*ruim)==5)
    {
        DrawTexture(fala,237,650,RAYWHITE);
        DrawText("Você sempre estraga tudo",450,720,20,RED);
    }
    if((*ruim)==6)
    {
        DrawTexture(fala,237,650,RAYWHITE);
        DrawText("Pense! Pense!",500,720,20,RED);
    }
    if((*ruim)==7)
    {
        DrawTexture(fala,237,650,RAYWHITE);
        DrawText("Há algo que você não está lembrando",450,720,20,RED);
    }
           
}

void tudoDaKarol(){
    
    int screenWidth = 1366; //dimenssão da minha tela
    int screenHeight = 768;
    
    int contadordetempo = 0;
    
    //Carregando imagem e transformando em textura:
    //Image:
        Image Quarto = LoadImage("/jogoip/Quarto002.png"); //diretorio apartir do C: com as \ invertidas (/);
        Image Jorgeim = LoadImage("/jogoip/Jorge01.png");
        Image memoriasim = LoadImage("/jogoip/memorias.png");
        Image monstro = LoadImage("/jogoip/monstro2.png");
        Image fala = LoadImage("/jogoip/fala.png");
        Image Karolim = LoadImage("/jogoip/Karol01.png");
        Image desafioim = LoadImage("/jogoip/aviao.png");

     //Image Resize:
        //ImageResize (&Jorgeim,144,104); //144,104,(108,78) - Aumentando a imagem original
        ImageResize (&Karolim,144,104);
        ImageResize (&Quarto,1366,788); //passar o endereço pq ele modifica a imagem original.
        ImageResize (&fala,900,200);
        ImageResize (&monstro,1300,678);
        ImageResize (&desafioim,96,102);
     //Texture2D:
        Texture2D Quartotx = LoadTextureFromImage(Quarto);
        //Texture2D Jorgetx = LoadTextureFromImage(Jorgeim);
        Texture2D Karoltx = LoadTextureFromImage(Karolim);
        Texture2D memoriastx = LoadTextureFromImage(memoriasim);
        Texture2D falatx = LoadTextureFromImage(fala);
        Texture2D desafiotx = LoadTextureFromImage(desafioim);
        Texture2D estabilidadetx = LoadTexture("/jogoip/estabilidade.png");
        Texture2D estressetx = LoadTexture("/jogoip/estresse.png");
        
     //Rectengles:
        //Rectangle Jorgerec = {0,0,53,102};// testando o tamanho do boneco no mapa (pegando só esse retângulo)
        Rectangle Karolrec = {0,0,55,102}; // Esta ok
        //Rectangle Guilhermerec = {0,0,55,102}; //se desejar aumentar manter a proporção para os 3 bonecos (usar multiplo)
       //Retângulo de movimentação:
        //Rectangle Jorger = {17,400,53,51}; //um retângulo de colisão que representa Jorge (metade da altura para colidir com o pé)
         Rectangle Karolr = {17,400,55,51};
       //criando colisão
        Rectangle estante = {330,116,979,180}; //colisão para a estante
        Rectangle memoria1 = {900,400,20,3};
        Rectangle memoria2 = {933,470,20,3};
        Rectangle memoria3 = {600,525,20,5};
        Rectangle memoria4 = {965,340,20,3};
        Rectangle memoriasad1 = {800,600,20,5};
        Rectangle conflito = {940,330,20,10};
        Rectangle conflito2 = {940,530,20,10};
        Rectangle conflito3 = {240,530,20,10};
        Rectangle conflito4 = {440,330,20,10};
        Rectangle conflito5 = {830,625,20,10};
        Rectangle conflito6 = {340,530,20,10};
        Rectangle conflito7 = {640,590,20,10};
        Rectangle mesa = {525,405,305,100};
        Rectangle pe1= {570,515,20,15};
        Rectangle pe2= {790,515,20,15};
        Rectangle lixo = {1070,304,113,20};
        Rectangle parede1 = {0,0,190,340};
        Rectangle parede2 = {1166,0,190,340};
        Rectangle parede3 = {221,304,55,20};
        Rectangle parede4 = {0,669,190,340};
        Rectangle parede5 = {1166,669,190,340};
        Rectangle falacolisao = {330,695,800,150};
        
        
        Rectangle memoriasrec = {0,0,30,20}; //ok!
        Rectangle memoriassadrec = {30,20,30,20}; //ok!
        
        
       //posição das memórias:
        Vector2 memoriasp = {900,400}; //ferias com a família
        Vector2 memoriasp2 = {933,470}; //ganhou um ps4
        Vector2 memoriasp3 = {600,525}; //passou de ano
        Vector2 memoriaspsad1 = {800,600}; //perdeu contato com um amigo querido
        Vector2 memoriap4 = {965,340};
       
        
    //variáveis :
    int memoria = 0;
    int stress = 5; //chegando a 0 aumenta estabilidade, chegando a 10 diminui.
    int estabilidade = 10; //chegando a 30 (exemplo) passa de nível, chegando a 0 perde
    int sad = 0; 
    int desafio = 0;
    int batalha = -1;
    int ruim = 0;
    int desenhar = 1;
    int diversao = 0;
    int terapia = 0;
    int remedio=0;
    int falac=0;
    int desenharmemoria[6] = {1,1,1,1,1,1};
    
    Music memory = LoadMusicStream("/jogoip/Memory.ogg");
    PlayMusicStream(memory);
    
    while (!WindowShouldClose()){
        UpdateMusicStream (memory);
         contadordetempo++;
         //Vector2 Jorgep = {Jorger.x,Jorger.y-51}; //posição do Jorge (menos 51 para a colisão ficar no pé)
         Vector2 Karolp = {Karolr.x,Karolr.y-51};
         //Posição do mouse na tela
         int x = GetMouseX();
         int y = GetMouseY();
        
        //função de movimentação do jorge:
         movimentacaoK(&Karolr);
        //Checando se saiu do mapa:
        tamanhotelaK(&Karolr,screenHeight,screenWidth);
        //atualizando estabilidade:
        atualizarestabilidade(&stress,&estabilidade);
        
        //checando colisão:
        if(CheckCollisionRecs(Karolr,estante)==1)
        {
            Karolr.y+=4;
            if(memoria==1 && IsKeyPressed(KEY_ENTER)==1)
            {
                if(sad==0)
                {
                    stress = stress-2;
                }
                else
                {
                    stress = stress+2;
                    sad=0;
                }
                
                memoria=0;
                ruim=0;
            }
        }
        else if(CheckCollisionRecs(Karolr,mesa)==1 ||CheckCollisionRecs(Karolr,pe1)==1|| CheckCollisionRecs(Karolr,pe2)==1)
        {
            colisaoK(&Karolr);
        }
        else if(CheckCollisionRecs(Karolr,parede1)==1) 
        {
            colisaoK(&Karolr);
            if(diversao==1)
            {
                
                desenhar=0;
                stress = stress - 5;
                diversao=0;
            }
            
        }
        else if(CheckCollisionRecs(Karolr,parede2)==1)
        {
            colisaoK(&Karolr);
            if(terapia==1)
            {
                desenhar=0;
                estabilidade = estabilidade + 5;
                terapia=0;
            }
            
        }
        else if(CheckCollisionRecs(Karolr,parede3))
        {
            colisaoK(&Karolr); 
        }
        else if(CheckCollisionRecs(Karolr,parede4) || CheckCollisionRecs(Karolr,parede5))
        {
            colisaoK(&Karolr); 
        }
        else if(CheckCollisionRecs(Karolr,memoria1)==1)
        {
            if(IsKeyPressed(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[0]=0;
                 memoria=1;
                 memoria1.x=0;
                 memoria1.y=0;
            }
            
            colisaoK(&Karolr);
        }
        else if(CheckCollisionRecs(Karolr,memoria2)==1)
        {
            if(IsKeyPressed(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[1]=0;
                 memoria=1;
                 memoria2.x=0;
                 memoria2.y=0;
            }
            colisaoK(&Karolr);
        }
        else if(CheckCollisionRecs(Karolr,memoria3))
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[2]=0;
                 memoria=1;
                 memoria3.x=0;
                 memoria3.y=0;
            }
            colisaoK(&Karolr);
        }
        else if(CheckCollisionRecs(Karolr,memoria4) && contadordetempo>=3600)
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[5]=0;
                 if(ruim>0)
                 {
                     memoria=1;
                     sad=1;
                     //criou um memória ruim:
                     stress = stress+3;
                     
                 }
                 else
                 {
                     memoria=1;
                     //recompensa por ter dado certo:
                     stress = stress-3;
                 }
                 
                 memoria4.x=0;
                 memoria4.y=0;
            }
            colisaoK(&Karolr);
        }
        else if(CheckCollisionRecs(Karolr,conflito)==1 && memoria==1)
        {
            ruim=1;
            colisaoK(&Karolr);
        }
        else if(CheckCollisionRecs(Karolr,conflito2)==1 && memoria==1)
        {
            ruim=2;
            colisaoK(&Karolr);
        }
         else if(CheckCollisionRecs(Karolr,conflito3)==1 && memoria==1)
        {
            ruim=3;
            colisaoK(&Karolr);
        }
         else if(CheckCollisionRecs(Karolr,conflito4)==1 && memoria==1)
        {
            ruim=4;
            colisaoK(&Karolr);
        }
        else if(CheckCollisionRecs(Karolr,conflito5)==1 && memoria==1)
        {
            ruim=5;
            colisaoK(&Karolr);
        }
        else if(CheckCollisionRecs(Karolr,conflito6)==1 && memoria==1)
        {
            ruim=6;
            colisaoK(&Karolr);
        }
        else if(CheckCollisionRecs(Karolr,conflito7)==1 && memoria==1)
        {
            ruim=7;
            colisaoK(&Karolr);
        }
        else if(CheckCollisionRecs(Karolr,memoriasad1))
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[3]=0;
                 memoria=1;
                 sad=1;
                 memoriasad1.x=0;
                 memoriasad1.y=0;
            }
            colisaoK(&Karolr);
        }
        else if (CheckCollisionRecs(Karolr,lixo))
        {
           if(IsKeyPressed(KEY_ENTER)==1 && memoria==1)
            {
                if(sad==1)
                {
                    stress--;
                    sad=0;
                }
                else
                {
                    stress = stress+3;
                }
                 memoria=0;
                 ruim=0;
            }
            colisaoK(&Karolr); 
        }  
        else if(CheckCollisionRecs(Karolr,falacolisao))
        {
           if(falac==1)
           {
              colisaoK(&Karolr);  
              falac=0;
           }
            
        }        
            int minutos = 3600;
            if(contadordetempo==2*minutos)
            {
                diversao=1;
                
            }
            if(contadordetempo==4*minutos)
            {
                terapia=1;
                //remedio=1;
                
               
            }
            if(contadordetempo==6*minutos)
            {
                diversao=1;
                
            }
            if(contadordetempo==8*minutos)
            {
                terapia=1;
               // remedio=1;
               
            }
            if(contadordetempo==10*minutos)
            {
                diversao=1;
                
            }
            
        //parte gráfica:
        BeginDrawing();
           ClearBackground(WHITE);
           DrawTexture(Quartotx,0,0,RAYWHITE);
           //DrawTexture(circulo1.posicaox,circulo1.posicaoy,RAYWHITE);
           //DrawTextureRec(Texture2D texture, Rectangle sourceRec, Vector2 position, Color tint); 
           DrawText(TextFormat("x: %i y: %i",x,y),605,15,40,RED);
           DrawText(TextFormat("Memoria: %i",memoria),15,680,35,BLACK);
           DrawTexture(estabilidadetx, 35, 8, WHITE);
           DrawTexture(estressetx, 35, estabilidadetx.height + 16, WHITE);
           DrawRectangleGradientH(39, 36,((estabilidade*0.1)/3)*325, 26, SKYBLUE, DARKBLUE);
           DrawRectangleGradientH(39, 104,(stress*0.1)*325, 25, RED, (Color){123, 20, 34, 255});
           //DrawText(TextFormat("Refletir: %i",refletir),15,710,35,BLACK); 
           DrawText(TextFormat("Fase 2"),629,94,35,BLACK);
           DrawText(TextFormat("Tempo: %0.1f", (float)(contadordetempo/100)),1150,42,30,BLACK);
           //DrawTextureRec(Karoltx,Karolrec,Karolp,RAYWHITE);
           //DrawTextureRec(Guilhermetx,Guilhermerec,Guilhermep,RAYWHITE);
           
           // desenhando memórias:
           if(desenharmemoria[0]==1)
           {
              DrawTextureRec(memoriastx,memoriasrec,memoriasp,RAYWHITE); 
           }
           if(desenharmemoria[1]==1)
           {
              DrawTextureRec(memoriastx,memoriasrec,memoriasp2,RAYWHITE);
           }
           if(desenharmemoria[2]==1)
           {
              DrawTextureRec(memoriastx,memoriasrec,memoriasp3,RAYWHITE);
           }
           if(desenharmemoria[3]==1)
           {
              DrawTextureRec(memoriastx,memoriassadrec,memoriaspsad1,RAYWHITE);
           }
           if(desenharmemoria[4]==1 && memoria==1)
           {
              DrawTexture(desafiotx,900,300,RAYWHITE);
              DrawTexture(desafiotx,900,500,RAYWHITE);
              DrawTexture(desafiotx,200,500,RAYWHITE);
              DrawTexture(desafiotx,400,300,RAYWHITE);
              DrawTexture(desafiotx,790,595,RAYWHITE);
              DrawTexture(desafiotx,300,500,RAYWHITE);
              DrawTexture(desafiotx,600,560,RAYWHITE);
           }
           //desenhando desafio:
           if(memoria==1)
           {
                 desafiofuncaoK(falatx,&ruim,&falac);
                 
           }
           //diversao e terapia:
           if(diversao==1)
           {
               diversaoavisoK(falatx, &falac, &Karolr, falacolisao);
           }
           if(terapia==1)
           {
               terapiaavisoK(falatx, &falac, &Karolr, falacolisao);
           }
           if(remedio==1)
           {
               remedioavisoK(falatx, &falac, &Karolr, falacolisao);
           }
           int espera = 1000; //modificar essa variável para reduzir o tempo de espera
          if(contadordetempo>=(2*minutos)+espera && contadordetempo<(4*minutos)) 
           {
               desenhar=1;
           }
           if(contadordetempo>=(4*minutos)+espera && contadordetempo<(6*minutos))
           {
               desenhar=1;
           }
           if(contadordetempo>=(6*minutos)+espera && contadordetempo<(8*minutos))
           {
               desenhar=1;
           }
           if(contadordetempo>=(8*minutos)+espera && contadordetempo<(10*minutos))
           {
               desenhar=1;
           }
           if(contadordetempo>=(10*minutos)+espera)
           {
               desenhar=1;
           }
           
           if(estabilidade >= 30)
           {
               // int tantoFaz = subiu_de_level(&checkpoint);
           }
           if(desenhar==1)
           {
               DrawTextureRec(Karoltx,Karolrec,Karolp,RAYWHITE);
           }
           
        EndDrawing();
    }
    CloseWindow();
    }// fim de tudo
    
    void tudoDoGuilherme() {
    int screenWidth = 1366; //dimenssão da minha tela
    int screenHeight = 768;
    
    int contadordetempo = 0;
    
    //Carregando imagem e transformando em textura:
    //Image:
        Image Quarto = LoadImage("/jogoip/Quarto002.png"); //diretorio apartir do C: com as \ invertidas (/);
        Image Guilhermeim = LoadImage("/jogoip/Guilherme01.png");
        Image memoriasim = LoadImage("/jogoip/memorias.png");
        Image monstro = LoadImage("/jogoip/monstro2.png");
        Image fala = LoadImage("/jogoip/fala.png");
        Image desafioim = LoadImage("/jogoip/aviao.png");
     //Image Resize:
        ImageResize (&Guilhermeim,144,104); //144,104,(108,78) - Aumentando a imagem original
        ImageResize (&Quarto,1366,788); //passar o endereço pq ele modifica a imagem original.
        ImageResize (&fala,1366,300);
        ImageResize (&monstro,1300,678);
        ImageResize (&desafioim,96,102);
     //Texture2D:
        Texture2D Quartotx = LoadTextureFromImage(Quarto);
        Texture2D Guilhermetx = LoadTextureFromImage(Guilhermeim);
        Texture2D memoriastx = LoadTextureFromImage(memoriasim);
        Texture2D falatx = LoadTextureFromImage(fala);
        Texture2D monstrotx = LoadTextureFromImage(monstro);
        Texture2D desafiotx = LoadTextureFromImage(desafioim);
        Texture2D estabilidadetx = LoadTexture("/jogoip/estabilidade.png");
        Texture2D estressetx = LoadTexture("/jogoip/estresse.png");
     //Rectengles:
        Rectangle Guilhermerec = {0,0,55,102};// testando o tamanho do boneco no mapa (pegando só esse retângulo)
        //Rectangle Karolrec = {0,0,55,102}; // Esta ok
        //Rectangle Guilhermerec = {0,0,55,102}; //se desejar aumentar manter a proporção para os 3 bonecos (usar multiplo)
       //Retângulo de movimentação:
        Rectangle Guilhermer = {17,400,53,51}; //um retângulo de colisão que representa Jorge (metade da altura para colidir com o pé)
       //criando colisão
        Rectangle estante = {330,116,979,180}; //colisão para a estante
        Rectangle memoria1 = {500,325,20,3};
        Rectangle memoria2 = {600,325,20,3};
        Rectangle memoria3 = {600,525,20,5};
        Rectangle memoria4 = {965,340,20,3};
        Rectangle memoria5 = {1025,560,30,5};
        Rectangle memoria6 = {130,520,30,5}; 
        Rectangle memoria10 = {995,400,30,3};
        Rectangle memoria11 = {1030,400,30,3};
        Rectangle memoriasad1 = {800,600,20,5};
        Rectangle memoriasad2 = {255,380,20,5};
        Rectangle memoriasad3 = {1270,540,30,5};
        Rectangle conflito = {930,300,70,80};
        Rectangle conflito2 = {995,400,70,80};
        Rectangle conflito3 = {1030,400,70,80};
        Rectangle mesa = {525,405,305,100};
        Rectangle pe1= {570,515,20,15};
        Rectangle pe2= {790,515,20,15};
        Rectangle lixo = {1070,304,113,20};
        Rectangle parede1 = {0,0,190,340};
        Rectangle parede2 = {1166,0,190,340};
        Rectangle parede3 = {221,304,55,20};
        Rectangle parede4 = {0,669,190,340};
        Rectangle parede5 = {1166,669,190,340};
        //Rectangle p1 = {};
        //Rectangle p2 = {};
        //Rectangle p3 = {};
        Rectangle falacolisao = {0,630,1300,300};
        Rectangle refletirec = {636,390,20,20};
        
        //recorte de imagem:
        Rectangle memoriasrec = {0,0,30,20}; //ok!
        Rectangle memoriassadrec = {30,20,30,20}; //ok!
        Rectangle conflitorec = {60,40,35,20};
        Rectangle monstrorec = {0,0,90,90};
        
       
        
        
       //posição das memórias:
        Vector2 memoriasp = {500,325}; //ferias com a família
        Vector2 memoriasp2 = {600,325}; //ganhou um ps4
        Vector2 memoriasp3 = {600,525}; //passou de ano
        Vector2 memoriasp5 = {130,520}; //conseguiu vencer algum medo 
        Vector2 memoriasp6 = {1025,560}; //fez uma nova amizade
        Vector2 memoriaspsad1 = {800,600}; //perdeu contato com um amigo querido
        Vector2 memoriap4 = {965,340};
        Vector2 memoriap10 = {1025,443};
        Vector2 memoriap11 = {1000,443};
        Vector2 memoriaspsad2 = {255,380}; //morte de um familiar
        Vector2 memoriaspsad3 = {1270,540}; //teve uma crise de pânico em público 
        Vector2 conflitop = {900,300};
        Vector2 conflitop2 = {965,400};
        Vector2 conflitop3 = {1000,400};
         
        
    //variáveis :
    int memoria = 0;
    int stress = 5; //chegando a 0 aumenta estabilidade, chegando a 10 diminui.
    int estabilidade = 10; //chegando a 30 (exemplo) passa de nível, chegando a 0 perde
    int sad = 0; 
    int desafio = 0;
    int batalha = -1;
    int batalha2= -1;
    int batalha3= -1;
    int ruim = 0;
    int ruim2=0;
    int ruim3=0;
    int desenhar = 1;
    int diversao = 0;
    int terapia = 0;
    int falac=0;
    int checkpoint = 0;
    int refletir=0;
    checkpoint = qual_level(0);
    int desenharmemoria[15] = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};
    Music space = LoadMusicStream("/jogoip/Space.ogg");
                PlayMusicStream(space);
        while (!WindowShouldClose()){
            UpdateMusicStream (space);
         contadordetempo++;
         //Vector2 Jorgep = {Jorger.x,Jorger.y-51}; //posição do Jorge (menos 51 para a colisão ficar no pé)
         Vector2 Guilhermep = {Guilhermer.x,Guilhermer.y-51};
         //Posição do mouse na tela
         int x = GetMouseX();
         int y = GetMouseY();
        
        //função de movimentação do jorge:
         movimentacaoK(&Guilhermer);
        //Checando se saiu do mapa:
        tamanhotelaK(&Guilhermer,screenHeight,screenWidth);
        //atualizando estabilidade:
        atualizarestabilidade(&stress,&estabilidade);
        
        //checando colisão:
        if(CheckCollisionRecs(Guilhermer,estante)==1)
        {
            Guilhermer.y+=4;
            if(memoria==1 && IsKeyPressed(KEY_ENTER)==1)
            {
                if(sad==0)
                {
                    stress = stress-2;
                }
                else
                {
                    stress = stress+2;
                    sad=0;
                }
                
                memoria=0;
                ruim=0;
            }
        }
        else if(CheckCollisionRecs(Guilhermer,mesa)==1 ||CheckCollisionRecs(Guilhermer,pe1)==1|| CheckCollisionRecs(Guilhermer,pe2)==1)
        {
            colisaoK(&Guilhermer);
        }
        else if(CheckCollisionRecs(Guilhermer,parede1)==1) 
        {
            colisaoK(&Guilhermer);
            if(diversao==1)
            {
                
                desenhar=0;
                stress = stress - 5;
                diversao=0;
            }
            
        }
        else if(CheckCollisionRecs(Guilhermer,parede2)==1)
        {
            colisaoK(&Guilhermer);
            if(terapia==1)
            {
                desenhar=0;
                estabilidade = estabilidade + 5;
                terapia=0;
            }
            
        }
        else if(CheckCollisionRecs(Guilhermer,parede3))
        {
            colisaoK(&Guilhermer); 
        }
        else if(CheckCollisionRecs(Guilhermer,parede4) || CheckCollisionRecs(Guilhermer,parede5))
        {
            colisaoK(&Guilhermer); 
        }
        else if(CheckCollisionRecs(Guilhermer,memoria1)==1)
        {
            if(IsKeyPressed(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[0]=0;
                 memoria=1;
                 memoria1.x=0;
                 memoria1.y=0;
            }
            
            colisaoK(&Guilhermer);
        }
        else if(CheckCollisionRecs(Guilhermer,memoria2)==1)
        {
            if(IsKeyPressed(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[1]=0;
                 memoria=1;
                 memoria2.x=0;
                 memoria2.y=0;
            }
            colisaoK(&Guilhermer);
        }
        else if(CheckCollisionRecs(Guilhermer,memoria3))
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[2]=0;
                 memoria=1;
                 memoria3.x=0;
                 memoria3.y=0;
            }
            colisaoK(&Guilhermer);
        }
        else if(CheckCollisionRecs(Guilhermer,memoria4) && contadordetempo>=3600)
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[5]=0;
                 if(ruim>0)
                 {
                     memoria=1;
                     sad=1;
                     //criou um memória ruim:
                     stress = stress+3;
                     
                 }
                 else
                 {
                     memoria=1;
                     //recompensa por ter dado certo:
                     stress = stress-3;
                 }
                 
                 memoria4.x=0;
                 memoria4.y=0;
            }
            colisaoK(&Guilhermer);
        }
        else if(CheckCollisionRecs(Guilhermer,conflito)==1 && memoria==1)
        {
            ruim=1;
            colisaoK(&Guilhermer);
        }
        else if(CheckCollisionRecs(Guilhermer,conflito2)==1 && memoria==1)
        {
            ruim=2;
            colisaoK(&Guilhermer);
        }
         else if(CheckCollisionRecs(Guilhermer,conflito3)==1 && memoria==1)
        {
            ruim=3;
            colisaoK(&Guilhermer);
        }
        else if(CheckCollisionRecs(Guilhermer,memoriasad1))
        {
            if(IsKeyDown(KEY_ENTER)==1 && memoria==0)
            {
                 desenharmemoria[3]=0;
                 memoria=1;
                 sad=1;
                 memoriasad1.x=0;
                 memoriasad1.y=0;
            }
            colisaoK(&Guilhermer);
        }
        else if (CheckCollisionRecs(Guilhermer,lixo))
        {
           if(IsKeyPressed(KEY_ENTER)==1 && memoria==1)
            {
                if(sad==1)
                {
                    stress--;
                    sad=0;
                }
                else
                {
                    stress = stress+3;
                }
                 memoria=0;
                 ruim=0;
            }
            colisaoK(&Guilhermer); 
        }  
        else if(CheckCollisionRecs(Guilhermer,falacolisao))
        {
           if(falac==1)
           {
              colisaoK(&Guilhermer);  
              falac=0;
           }
            
        }        
            int minutos = 3600;
            if(contadordetempo==2*minutos)
            {
                diversao=1;
                
            }
            if(contadordetempo==4*minutos)
            {
                terapia=1;
                //remedio=1;
                
               
            }
            if(contadordetempo==6*minutos)
            {
                diversao=1;
                
            }
            if(contadordetempo==8*minutos)
            {
                terapia=1;
               // remedio=1;
               
            }
            if(contadordetempo==10*minutos)
            {
                diversao=1;
                
            }
            
        //parte gráfica:
        BeginDrawing();
           ClearBackground(WHITE);
           DrawTexture(Quartotx,0,0,RAYWHITE);
           //DrawTexture(circulo1.posicaox,circulo1.posicaoy,RAYWHITE);
           //DrawTextureRec(Texture2D texture, Rectangle sourceRec, Vector2 position, Color tint); 
           DrawText(TextFormat("x: %i y: %i",x,y),605,15,40,RED);
           DrawText(TextFormat("Memoria: %i",memoria),15,680,35,BLACK);
           DrawTexture(estabilidadetx, 35, 8, WHITE);
           DrawTexture(estressetx, 35, estabilidadetx.height + 16, WHITE);
           DrawRectangleGradientH(39, 36,((estabilidade*0.1)/3)*325, 26, SKYBLUE, DARKBLUE);
           DrawRectangleGradientH(39, 104,(stress*0.1)*325, 25, RED, (Color){123, 20, 34, 255});
           //DrawText(TextFormat("Refletir: %i",refletir),15,710,35,BLACK); 
           DrawText(TextFormat("Fase 3"),629,94,35,BLACK);
           DrawText(TextFormat("Tempo: %0.1f", (float)(contadordetempo/100)),1150,42,30,BLACK);
           //DrawTextureRec(Karoltx,Karolrec,Karolp,RAYWHITE);
           //DrawTextureRec(Guilhermetx,Guilhermerec,Guilhermep,RAYWHITE);
           
           // desenhando memórias:
           if(desenharmemoria[0]==1)
           {
              DrawTextureRec(memoriastx,memoriasrec,memoriasp,RAYWHITE); 
           }
           if(desenharmemoria[1]==1)
           {
              DrawTextureRec(memoriastx,memoriasrec,memoriasp2,RAYWHITE);
           }
           if(desenharmemoria[2]==1)
           {
              DrawTextureRec(memoriastx,memoriasrec,memoriasp3,RAYWHITE);
           }
           if(desenharmemoria[3]==1)
           {
              DrawTextureRec(memoriastx,memoriassadrec,memoriaspsad1,RAYWHITE);
           }
           if(desenharmemoria[4]==1 && memoria==1)
           {
              DrawTexture(desafiotx,900,300,RAYWHITE);
             DrawTexture(desafiotx,900,500,RAYWHITE);
              DrawTexture(desafiotx,200,500,RAYWHITE);
              DrawTexture(desafiotx,400,300,RAYWHITE);
              DrawTexture(desafiotx,790,595,RAYWHITE);
              DrawTexture(desafiotx,300,500,RAYWHITE);
              DrawTexture(desafiotx,600,560,RAYWHITE);
           }
           //desenhando desafio:
           if(memoria==1)
           {
                 desafiofuncaoK(falatx,&ruim,&falac);
                 
           }
           //diversao e terapia:
           if(diversao==1)
           {
               diversaoavisoK(falatx, &falac, &Guilhermer, falacolisao);
           }
           if(terapia==1)
           {
               terapiaavisoK(falatx, &falac, &Guilhermer, falacolisao);
           }
           int espera = 1000; //modificar essa variável para reduzir o tempo de espera
          if(contadordetempo>=(2*minutos)+espera && contadordetempo<(4*minutos)) 
           {
               desenhar=1;
           }
           if(contadordetempo>=(4*minutos)+espera && contadordetempo<(6*minutos))
           {
               desenhar=1;
           }
           if(contadordetempo>=(6*minutos)+espera && contadordetempo<(8*minutos))
           {
               desenhar=1;
           }
           if(contadordetempo>=(8*minutos)+espera && contadordetempo<(10*minutos))
           {
               desenhar=1;
           }
           if(contadordetempo>=(10*minutos)+espera)
           {
               desenhar=1;
           }
           
           if(estabilidade >= 30)
           {
               // int tantoFaz = subiu_de_level(&checkpoint);
           }
           if(desenhar==1)
           {
               DrawTextureRec(Guilhermetx,Guilhermerec,Guilhermep,RAYWHITE);
           }
           
        EndDrawing();
    }
    CloseWindow();
    }//SXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
    



void menu()
{    
   
          Music maya = LoadMusicStream("/jogoip/Maya.ogg");
                PlayMusicStream(maya);

        int posic_circ = 470;
        Image Menu = LoadImage("/jogoip/menu.png");
        ImageResize (&Menu,1366,788);
        Texture2D Menutx = LoadTextureFromImage(Menu);
        
    while(!WindowShouldClose()){
        UpdateMusicStream(maya);
        BeginDrawing();
               ClearBackground(RAYWHITE);
               DrawTexture(Menutx,0,0,RAYWHITE);
               int x = GetMouseX();
               int y = GetMouseY();
               DrawText(TextFormat("x: %i y: %i",x,y),10,15,40,RED);
               DrawText("Fase 1",600,450,50,BLACK);
               DrawText("Fase 2",600,500,50,BLACK);
               DrawText("Fase 3",600,550,50,BLACK);
               DrawText("Sobre nós",600,600,50,BLACK);
               DrawCircle(580,posic_circ,10,RED);
               move_circ(&posic_circ);
               
        int opcMenu = 0;
        
        int checkpoint = qual_level(0);
        
        if (posic_circ == 470 && IsKeyPressed(KEY_ENTER)){
            opcMenu = 1;
        }else if ((posic_circ == 520 && IsKeyPressed(KEY_ENTER)) && checkpoint >= 2){
            opcMenu = 2;
        }else if ((posic_circ == 570 && IsKeyPressed(KEY_ENTER)) && checkpoint >= 3){
            opcMenu = 3;
        }else if (posic_circ == 620 && IsKeyPressed(KEY_ENTER)){
            opcMenu = 4;
        }
        EndDrawing();
        switch(opcMenu){
            case 1 : 
                tudoDoJorge();
                break;
            //end case 1
            case 2 : 
                tudoDaKarol();
                break;
            //end case 2
            case 3 : 
                tudoDoGuilherme();
                break;
            //end case 3
            case 4 : 
                sobrenos();
                break;
            //end case 4
        }//end switch
    }//end window should close
}// end função menu 

int qual_level(int checkpoint){
     //PARA O ARMAZENAMENTO (LER)
    FILE *level;
    level = fopen("checkpoint.txt" , "r");
    //Variavel aonde estará armazenado em qual fase ele está
    int levelum = 0, leveldois = 0, leveltres = 0;
    //Função que escreve do arquivo (.txt) e passa para as variaveis levelum, leveldois, leveltres
    fscanf(level, "%i %i %i", &levelum, &leveldois, &leveltres);
    //Função para parar de ler o arquivo
    fclose(level);
    //Caso o jogador só tenha o primeiro level desbloqueado
    int check = levelum + leveldois + leveltres;
    if(check == 1){
        return 1;
    }else
    if(check == 2){
        return 2;
    }else
    if(check == 3){
        return 3;
    }
    return 1;
}// end of non-void function


void subiu_de_level (){
    //ESCREVENDO NO ARQUIVO (checkpoint.txt)
    FILE *level;
    level = fopen("checkpoint.txt" , "w");
    //Variaveis criadas no escopo dessa função
    int check = qual_level(0);
    //Se a função for chamada quando o checkpoint = 1; será escrito no arquivo checkpoint.txt 1 1 0
    if(check == 1){
        int  a = 1, b = 1, c = 0;
        fprintf(level , "%i %i %i", a, b, c);
    }
    //Se a função for chamada quando o checkpoint = 2; será escrito no arquivo checkpoint.txt 1 1 1
    if(check == 2){   
        int  a = 1 , b = 1, c = 1;
        fprintf(level , "%i %i %i", a, b, c);
    }
    fclose(level);
}//end subiu


           
int main(void)
{
    const int screenWidth = 1366; 
    const int screenHeight = 768;
     
    InitWindow(screenWidth, screenHeight, " Pixelmind ");
    InitAudioDevice();
    SetTargetFPS(60);    
   
    
    menu();
   
    return 0;
}
